<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>B·∫£n Cam K·∫øt T√¨nh Y√™u</title>
  <style>
    :root{
      --bg:#fff5f8;
      --card:#ffffff;
      --accent:#ff356b;
      --muted:#6b6b6b;
      --paper:#fffdf6;
      --shadow: 0 8px 24px rgba(0,0,0,0.08);
      --radius:14px;
      --maxw:900px;
      --padding:26px;
    }
    *{box-sizing:border-box}
    body{
      font-family: 'Segoe UI', Roboto, 'Noto Sans', Arial;
      background:linear-gradient(180deg,#fff0f5 0%, #fff5f0 100%);
      padding:30px;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh
    }
    .wrap{width:100%; max-width:var(--maxw)}
    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:var(--padding);
    }
    header{
      display:flex;
      gap:18px;
      align-items:center;
      margin-bottom:18px
    }
    .logo{
      width:76px; height:76px;
      border-radius:12px;
      background:linear-gradient(135deg,#ffd1e6, #ff9ab8);
      display:flex;
      align-items:center;
      justify-content:center;
      color:white;
      font-weight:800;
      font-size:20px
    }
    h1.title{font-size:20px; margin:0; letter-spacing:1px}
    p.lead{margin:0; color:var(--muted); font-size:13px}
    .controls{
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
      justify-content: center;
    }
    .btn{padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:600}
    .btn-primary{background:var(--accent); color:white}
    .btn-ghost{background:#fff; border:1px solid #eee}
    .paper{
      background:var(--paper);
      padding:22px;
      border-radius:10px;
      margin-top:18px;
    }
    .center{text-align:center}
    .seal{font-size:18px; font-weight:800; color:var(--accent); margin-bottom:6px}
    .motto{color:var(--muted); font-style:italic; margin-bottom:18px}
    .content{line-height:1.6; color:#222}
    .content h2{margin-top:10px}
    label{
      display:block;
      font-size:18px;
      color:var(--muted);
      font-weight: 500;
    }
    input[type=text], textarea, .small-input{
      padding:10px;
      border-radius:8px;
      border:1px dashed pink;
      background:transparent;
      width: 70%;
      margin: 5px;
    }
    textarea{min-height:80px}
    .two-col{
      display: flex;
      gap: 14px;
      margin-top: 8px;
      flex-wrap: nowrap;
    }
    .two-col > div{
      flex: 1;
      min-width: 0;
    }
    .sig-row{
      display:flex;
      gap:12px;
      align-items:center;
      margin-top:8px
    }
    .sig-box{
      flex:1;
      min-height:70px;
      border-radius:8px;
      border:1px dashed #ffd6e6;
      background:white;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative
    }
    .sig-buttons{display:flex; gap:8px}
    .sig-box[contenteditable="true"] {
      cursor: text;
      text-align: center;
      font-family: 'Segoe UI', Roboto, Arial, sans-serif;
      font-size: 15px;
    }
    .preview{
      border-top:1px dashed #ffe7ef;
      margin-top:14px;
      padding-top:12px
    }
    .note{font-size:12px; color:var(--muted); margin-top:6px}
    .heart{font-size:22px; color:var(--accent); margin-left:8px}
    .add-btn{
      margin-left:8px;
      font-weight:bold;
      cursor:pointer;
      border:none;
      background:#ffdee5;
      border-radius:50%;
      width:24px;
      height:24px;
      color:#ff356b;
    }
    .add-btn:hover{background:#ffb6c1;}
    li[contenteditable="true"]{
      outline: 1px dashed #ff9ab8;
      padding:2px 4px;
      margin:2px 0;
    }
    @media(max-width:620px){
      .two-col{grid-template-columns:1fr}
      body {padding: 8px;}
      .wrap {max-width: 100vw;}
      .card {padding: 12px;}
      .two-col {grid-template-columns: 1fr; gap: 8px;}
      header {flex-direction: column; gap: 8px; align-items: flex-start;}
      .logo {width: 56px; height: 56px; font-size: 16px;}
      .paper {padding: 10px;}
      .sig-box {min-height: 70px;}
      .content p{font-size: 14px;}
    }
    @media print {
      .two-col {
        display: flex !important;
        flex-wrap: nowrap !important;
        gap: 14px !important;
      }
      .two-col > div {
        flex: 1;
        min-width: 0;
      }
      .wrap {
        padding-top: 10px !important;
        margin-top: 0 !important;
      }
    }
    .wrap, .clause, .two-col {
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .dialog-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeOut 0.2s forwards;
    }
    .dialog-box {
      background: white;
      padding: 20px;
      border-radius: 14px;
      text-align: center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
      transform: scale(0.8);
      opacity: 0;
      animation: zoomOut 0.2s forwards;
    }
    .dialog-overlay.show {
      display: flex;
      animation: fadeIn 0.3s forwards;
    }
    .dialog-overlay.show .dialog-box {
      animation: zoomIn 0.3s forwards;
    }
    .dialog-actions {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    .dialog-msg {
      font-size: 13px;
      color: #666;
      margin: 6px 0 0;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    @keyframes zoomOut { from { transform: scale(1); opacity: 1; } to { transform: scale(0.8); opacity: 0; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="controls">
        <button class="btn btn-primary" id="savePdfBtn">ƒê·ªìng √ù</button>
      </div>
      <p class="note" style="text-align: center;">L∆∞u √Ω: c·∫ßn ƒëi·ªÅn ƒë·∫ßy ƒë·ªß v√† ƒë·ªçc h·∫øt c√°c ƒëi·ªÅu kho·∫£n tr∆∞·ªõc khi ƒë·ªìng √Ω.</p>
      <section class="paper" id="exportContent">
        <div class="center">
          <div class="seal">C·ªòNG H√íA T√åNH Y√äU Vƒ®NH C·ª¨U</div>
          <h1 class="title">B·∫¢N CAM K·∫æT T√åNH Y√äU</h1>
          <div class="motto">Ng·ªçt ng√†o ‚Äì Chung th·ªßy ‚Äì H·∫°nh ph√∫c</div>
        </div>
        <div class="content">
          <p>H√¥m nay, ng√†y <span id="preDay">‚Ä¶</span> th√°ng <span id="preMonth">‚Ä¶</span> nƒÉm <span id="preYear">‚Ä¶</span>, t·∫°i tr√°i tim c·ªßa c·∫£ hai, ch√∫ng t√¥i g·ªìm c√≥:</p>
          <div class="two-col">
            <div>
              <h3>B√™n A (N√≥c Nh√†)</h3>
              <label>H·ªç v√† t√™n: <input type="text" id="nameA" value="L√Ω Th√πy An" readonly /></label>
              <label>Bi·ªát danh: <input type="text" id="nickA" value="B√© Iu ü•∞" readonly /></label>
            </div>
            <div>
              <h3>B√™n B (C·ªôt nh√†)</h3>
              <label>H·ªç v√† t√™n: <input type="text" id="nameB" value="L√™ VƒÉn T√∫" readonly /></label>
              <label>Bi·ªát danh: <input type="text" id="nickB" placeholder="C·∫ßn b√© ƒë·∫∑t cho" /></label>
            </div>
          </div>
          <h3>ƒêi·ªÅu kho·∫£n</h3>
          <div id="clauses">
            <div class="clause">
              <strong>ƒêi·ªÅu 1. L·ªùi h·ª©a chung</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>Y√™u th∆∞∆°ng nhau v√¥ ƒëi·ªÅu ki·ªán.</li>
                <li>Kh√¥ng gi·∫≠n qu√° 24 gi·ªù, n·∫øu gi·∫≠n ph·∫£i l√†m l√†nh b·∫±ng m·ªôt c√°i √¥m.</li>
                <li>T√¥n tr·ªçng, tin t∆∞·ªüng v√† lu√¥n n√≥i th·∫≠t (tr·ª´ vi·ªác gi·∫•u qu√† b·∫•t ng·ªù).</li>
              </ul>
            </div>
            <div class="clause">
              <strong>ƒêi·ªÅu 2. Quy·ªÅn l·ª£i c·ªßa ƒë√¥i b√™n</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>ƒê∆∞·ª£c y√™u th∆∞∆°ng, quan t√¢m 24/7.</li>
                <li>ƒê∆∞·ª£c quy·ªÅn l√†m n≈©ng, h·ªùn d·ªói, v√† ƒë∆∞·ª£c d·ªó d√†nh.</li>
                <li>ƒê∆∞·ª£c c√πng nhau ƒÉn u·ªëng, ƒëi ch∆°i, v√† t·∫°o k·ª∑ ni·ªám ƒë·∫πp.</li>
              </ul>
            </div>
            <div class="clause">
              <strong>ƒêi·ªÅu 3. Nghƒ©a v·ª•</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>Ph·∫£i nh·∫Øn tin/g·ªçi ƒëi·ªán khi nh·ªõ (kh√¥ng ƒë∆∞·ª£c l∆∞·ªùi).</li>
                <li>Lu√¥n chƒÉm s√≥c, lo l·∫Øng v√† ƒë·ªông vi√™n nhau.</li>
                <li>Kh√¥ng ƒë∆∞·ª£c b·ªè r∆°i, kh√¥ng ƒë∆∞·ª£c qu√™n ng√†y k·ª∑ ni·ªám.</li>
              </ul>
            </div>
            <div class="clause">
              <strong>ƒêi·ªÅu 4. Gi·∫£i quy·∫øt m√¢u thu·∫´n</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>N·∫øu c√£i nhau, ng∆∞·ªùi sai ph·∫£i xin l·ªói tr∆∞·ªõc (n·∫øu kh√¥ng bi·∫øt ai sai th√¨ c·∫£ hai c√πng xin l·ªói).</li>
                <li>B·∫•t k·ª≥ m√¢u thu·∫´n n√†o c≈©ng ph·∫£i k·∫øt th√∫c b·∫±ng m·ªôt n·ª• h√¥n.</li>
              </ul>
            </div>
            <div class="clause">
              <strong>ƒêi·ªÅu 5. ƒêi·ªÅu kho·∫£n b·∫•t ng·ªù</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>B·∫•t k·ª≥ l√∫c n√†o c≈©ng c√≥ th·ªÉ √¥m/l√†m n≈©ng m√† kh√¥ng c·∫ßn l√Ω do.</li>
                <li>Ph·∫£i ch·∫•p nh·∫≠n nh·ªØng tr√≤ b·∫•t ng·ªù ho·∫∑c prank d·ªÖ th∆∞∆°ng c·ªßa ƒë·ªëi ph∆∞∆°ng.</li>
              </ul>
            </div> 
            <div class="clause">
              <strong>ƒêi·ªÅu 6. T·∫ßn su·∫•t g·∫∑p nhau</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>G·∫∑p nhau √≠t nh·∫•t 1 l·∫ßn/Th√°ng ƒë·ªÉ gi·ªØ t√¨nh c·∫£m lu√¥n ng·ªçt ng√†o.</li>
                <li>Trong tr∆∞·ªùng h·ª£p b·∫≠n r·ªôn, c√≥ th·ªÉ thay b·∫±ng video call h·∫±ng ng√†y.</li>
              </ul>
            </div>
            <div class="clause">
              <strong>ƒêi·ªÅu 7. Th·ªùi h·∫°n cam k·∫øt</strong> <button class="add-btn" onclick="addItem(this)">+</button>
              <ul>
                <li>Hi·ªáu l·ª±c: K·ªÉ t·ª´ ng√†y k√Ω.</li>
                <li>Th·ªùi gian: M√£i m√£i v√† kh√¥ng bao gi·ªù h·∫øt h·∫°n.</li>
              </ul>
            </div>
            <div class="preview"></div>
            <h3 class="center">ƒê·∫†I DI·ªÜN C√ÅC B√äN CAM K·∫æT</h3>
            <div class="sig-row">
              <div style="flex:1">
                  <label style="text-align: center;">B√™n A </label>
                  <div class="sig-box" id="sigA" contenteditable="true"></div>
              </div>
              <div style="flex:1">
                  <label style="text-align: center;">B√™n B </label>
                  <div class="sig-box" id="sigB" contenteditable="false"> T√∫ </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <div id="confirmDialog" class="dialog-overlay">
        <div class="dialog-box">
            <h3>Em ƒë√£ ch·∫Øc ch·∫Øn l√† ƒë√£ ƒë·ªçc k·ªπ r·ªìi ch·ª© ?</h3>
            <p class="dialog-msg">ƒê√£ k√Ω b·∫£n cam k·∫øt n√†y r·ªìi l√† ph·∫£i th·ª±c hi·ªán theo ƒë·∫•y nh√© !!!</p>
            <div class="dialog-actions">
            <button id="confirmYes" class="btn btn-primary">Ch·∫Øc Ch·∫Øn</button>
            <button id="confirmNo" class="btn btn-ghost">Kh√¥ng</button>
            </div>
            <p class="note" style="text-align: center;">L∆∞u xong g·ª≠i cho a xem v·ªõi nh√° !!</p>
        </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    const nameA = document.getElementById('nameA');
    const nickA = document.getElementById('nickA');
    const nameB = document.getElementById('nameB');
    const nickB = document.getElementById('nickB');
    const sigA = document.getElementById('sigA');
    const sigB = document.getElementById('sigB');
    const preDay = document.getElementById('preDay');
    const preMonth = document.getElementById('preMonth');
    const preYear = document.getElementById('preYear');

    window.addEventListener('load', ()=>{
      const d = new Date();
      preDay.textContent = String(d.getDate()).padStart(2,'0');
      preMonth.textContent = String(d.getMonth()+1).padStart(2,'0');
      preYear.textContent = d.getFullYear();
    });

    sigA.addEventListener('dblclick', ()=> sigA.innerHTML += ' ‚ô•');
    sigB.addEventListener('dblclick', ()=> sigB.innerHTML += ' ‚ô•');

    function addItem(button){
      const ul = button.nextElementSibling;
      const li = document.createElement('li');
      li.contentEditable = true;
      li.textContent = '';
      ul.appendChild(li);
      li.focus();
    }

    const confirmDialog = document.getElementById('confirmDialog');
    const confirmYes = document.getElementById('confirmYes');
    const confirmNo = document.getElementById('confirmNo');

    document.getElementById('savePdfBtn').addEventListener('click', ()=>{
      if(nickB.value.trim() === ""){
        alert("B√© c·∫ßn ƒë·∫∑t bi·ªát danh cho B√™n B tr∆∞·ªõc khi ti·∫øp t·ª•c.");
        nickB.focus();
        return;
      }
      if(sigA.innerText.trim() === ""){
        alert("Vui l√≤ng xin b√© h√£y k√Ω t√™n tr∆∞·ªõc khi ti·∫øp t·ª•c.");
        return;
      }
      confirmDialog.classList.add('show');
    });

    confirmNo.addEventListener('click', ()=>{
      confirmDialog.classList.remove('show');
    });

    function sendDataToSheet() {
      const clausesEl = document.querySelectorAll('#clauses li');
      const clauses = Array.from(clausesEl).map(li => li.textContent.trim());
      const payload = {
        nickB: nickB.value,
        clauses: clauses
      };
      return fetch("https://script.google.com/macros/s/AKfycbygYPAGE5TAam2QKsiUxvlkHTFDbcA9vqkP5dMj28IN4y1KxNsSIXGCsTOqz3G846b0Ig/exec", {
        method: "POST",
        body: JSON.stringify(payload)
      })
      .then(res => res.json());
    }

    confirmYes.addEventListener('click', ()=>{
      confirmDialog.classList.remove('show');
      sendDataToSheet().then(res=>{
        const element = document.getElementById('exportContent');
        const addBtns = element.querySelectorAll('.add-btn');
        addBtns.forEach(btn=>btn.style.display='none');
        html2pdf().set({margin:0.5, filename:`CamKetTinhYeu.pdf`, html2canvas:{scale:2}}).from(element).save();
      });
    });
  </script>
</body>
</html>
